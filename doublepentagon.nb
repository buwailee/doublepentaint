(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     78307,       2183]
NotebookOptionsPosition[     74932,       2124]
NotebookOutlinePosition[     75385,       2141]
CellTagsIndexPosition[     75342,       2138]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellLabel->
  "In[125]:=",ExpressionUUID->"4eed7f46-ab5e-4236-a45d-3697a690bc53"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.812386074226305*^9, 3.812386087788026*^9}, 
   3.812386142124919*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"c2ff0413-27c4-4a73-a5e0-e9a8eca4f15f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Numerical", " ", "evaluation"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"capexpand", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"ab", "[", 
         RowBox[{"x___", ",", " ", 
          RowBox[{"cap", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a_", ",", " ", "b_"}], "}"}], ",", " ", 
            RowBox[{"{", "c__", "}"}]}], "]"}], ",", " ", "y___"}], "]"}], 
        " ", ":>", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"b", ",", " ", "c"}], "]"}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"x", ",", " ", "a", ",", " ", "y"}], "]"}]}], " ", "+", 
         " ", 
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"c", ",", " ", "a"}], "]"}], " ", 
          RowBox[{"ab", "[", 
           RowBox[{"x", ",", " ", "b", ",", " ", "y"}], "]"}]}]}]}], ",", 
       "\n", "               ", 
       RowBox[{
        RowBox[{"ab", "[", 
         RowBox[{"x___", ",", 
          RowBox[{"cap1", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a_", ",", "b_"}], "}"}], ",", 
            RowBox[{"{", "c__", "}"}], ",", 
            RowBox[{"{", "d__", "}"}]}], "]"}], ",", "y___"}], "]"}], 
        "\[RuleDelayed]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{"Length", "[", 
           RowBox[{"{", "y", "}"}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{"x", ",", "y", ",", "a", ",", "c"}], "]"}], 
            RowBox[{"ab", "[", 
             RowBox[{"x", ",", "y", ",", "b", ",", "d"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{"x", ",", "y", ",", "a", ",", "d"}], "]"}], 
            RowBox[{"ab", "[", 
             RowBox[{"x", ",", "y", ",", "b", ",", "c"}], "]"}]}]}], 
          ")"}]}]}], ",", "\n", "               ", 
       RowBox[{
        RowBox[{"ab", "[", 
         RowBox[{"a___", ",", 
          RowBox[{"cap2", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"c_", ",", "d_", ",", "e_"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"f_", ",", "g_", ",", "h_"}], "}"}]}], "]"}], ",", 
          "b___"}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"a", ",", "c", ",", "d", ",", "b"}], "]"}], 
          RowBox[{"ab", "[", 
           RowBox[{"e", ",", "f", ",", "g", ",", "h"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"a", ",", "d", ",", "e", ",", "b"}], "]"}], 
          RowBox[{"ab", "[", 
           RowBox[{"c", ",", "f", ",", "g", ",", "h"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"a", ",", "e", ",", "c", ",", "b"}], "]"}], 
          RowBox[{"ab", "[", 
           RowBox[{"d", ",", "f", ",", "g", ",", "h"}], "]"}]}]}]}]}], 
      "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"sortab", "=", 
     RowBox[{"{", 
      RowBox[{"i_ab", "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"ordercup", "[", "i", "]"}], 
        RowBox[{
         RowBox[{"Signature", "[", "i", "]"}], "/", 
         RowBox[{"Signature", "[", 
          RowBox[{"ordercup", "[", "i", "]"}], "]"}]}]}]}], "}"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ordercup", "[", "exp_", "]"}], ":=", 
     RowBox[{"SortBy", "[", 
      RowBox[{"exp", ",", 
       RowBox[{
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "#", "]"}], "===", "cap"}], ",", "1.5", ",", 
          RowBox[{
           RowBox[{"Head", "[", "#", "]"}], "===", "shift"}], ",", "1.4", ",", 
          RowBox[{"#", "===", "yy"}], ",", "4", ",", "True", ",", "#"}], 
         "]"}], "&"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"shifexp", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ab", "[", 
        RowBox[{"x___", ",", 
         RowBox[{"shift", "[", 
          RowBox[{"y_", ",", "z_"}], "]"}], ",", "w___"}], "]"}], ":>", 
       RowBox[{
        RowBox[{"ab", "[", 
         RowBox[{"x", ",", 
          RowBox[{"y", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           ",", "w"}], "]"}], "+", 
        RowBox[{"z", " ", 
         RowBox[{"ab", "[", 
          RowBox[{"x", ",", 
           RowBox[{
           "y", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
           "w"}], "]"}]}]}]}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"mom", "=", 
     RowBox[{"RandomInteger", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"20", ",", "4"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"mom1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Binomial", "[", 
        RowBox[{
         RowBox[{"n", "+", "i"}], ",", "i"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "20"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"neab", "[", "exp_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"exp", "/.", "shifexp"}], "//.", "capexpand"}], "/.", 
      RowBox[{
       RowBox[{"ab", "[", "x__", "]"}], "\[RuleDelayed]", 
       RowBox[{"Det", "[", 
        RowBox[{"mom", "[", 
         RowBox[{"[", 
          RowBox[{"{", "x", "}"}], "]"}], "]"}], "]"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"neab1", "[", "exp_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"exp", "/.", "shifexp"}], "//.", "capexpand"}], "/.", 
      RowBox[{
       RowBox[{"ab", "[", "x__", "]"}], "\[RuleDelayed]", 
       RowBox[{"Det", "[", 
        RowBox[{"mom1", "[", 
         RowBox[{"[", 
          RowBox[{"{", "x", "}"}], "]"}], "]"}], "]"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"randomPositiveZs", "[", "n_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Zs", "=", 
       RowBox[{"Nest", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", "mat", "}"}], ",", 
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"hatted", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"mat", "\[LeftDoubleBracket]", 
                    RowBox[{"#1", ";;", 
                    RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "]"}], 
                    ",", "1"}], "]"}], "&"}], ")"}], "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{"2", ",", 
                    RowBox[{"Length", "[", "mat", "]"}]}], "]"}]}], ",", 
                  RowBox[{"Append", "[", 
                   RowBox[{
                    RowBox[{"PadRight", "[", 
                    RowBox[{
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    "mat", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}]}], "]"}], ",", "1"}], 
                   "]"}]}], "]"}]}], ",", 
               RowBox[{"newRow", "=", 
                RowBox[{"RandomInteger", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"1", ",", "10"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"Length", "[", "mat", "]"}], "}"}]}], "]"}]}]}], 
              "}"}], ",", 
             RowBox[{"newRow", " ", "hatted"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "10"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"n", "+", "8"}], ",", "1"}], "}"}]}], "]"}], ",", "3"}], 
        "]"}]}], ";", 
      RowBox[{"Zs", "=", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{
          RowBox[{"Inverse", "[", 
           RowBox[{"Transpose", "[", 
            RowBox[{"Zs", "\[LeftDoubleBracket]", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], 
             "\[RightDoubleBracket]"}], "]"}], "]"}], ".", 
          RowBox[{"Transpose", "[", "Zs", "]"}]}], "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"5", ";;", 
         RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], ";"}], ")"}]}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"neabp", "[", "exp_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"exp", "/.", "\[VeryThinSpace]", "shifexp"}], "//.", 
        "\[VeryThinSpace]", "capexpand"}], "//.", 
       RowBox[{
        RowBox[{"ab", "[", 
         RowBox[{"x___", ",", "yy", ",", "y___"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"ab", "[", 
         RowBox[{"x", ",", "5", ",", "y"}], "]"}]}]}], "/.", 
      "\[VeryThinSpace]", 
      RowBox[{
       RowBox[{"ab", "[", "x__", "]"}], "\[RuleDelayed]", 
       RowBox[{"Det", "[", 
        RowBox[{"Zs", "\[LeftDoubleBracket]", 
         RowBox[{"{", "x", "}"}], "\[RightDoubleBracket]"}], "]"}]}]}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"randomPositiveZs", "[", "20", "]"}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ab", "[", 
      RowBox[{"___", ",", "i_", ",", "___", ",", "i_", ",", "___"}], "]"}], ":=",
      "0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"xexpand", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ab", "[", 
        RowBox[{"a___", ",", "xx", ",", "b___"}], "]"}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"ab", "[", 
         RowBox[{"a", ",", "12", ",", "b"}], "]"}], "-", 
        RowBox[{"\[Tau]", " ", 
         FractionBox[
          RowBox[{"ab", "[", 
           RowBox[{"10", ",", "11", ",", "12", ",", "1"}], "]"}], 
          RowBox[{"ab", "[", 
           RowBox[{"10", ",", "11", ",", "1", ",", "2"}], "]"}]], " ", 
         RowBox[{"ab", "[", 
          RowBox[{"a", ",", "2", ",", "b"}], "]"}]}]}]}], "}"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"yexpand", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ab", "[", 
        RowBox[{"a___", ",", "yy", ",", "b___"}], "]"}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"ab", "[", 
         RowBox[{"a", ",", "3", ",", "b"}], "]"}], "-", 
        RowBox[{"\[Sigma]", " ", 
         FractionBox[
          RowBox[{"ab", "[", 
           RowBox[{"3", ",", "4", ",", "6", ",", "7"}], "]"}], 
          RowBox[{"ab", "[", 
           RowBox[{"4", ",", "5", ",", "6", ",", "7"}], "]"}]], " ", 
         RowBox[{"ab", "[", 
          RowBox[{"a", ",", "5", ",", "b"}], "]"}]}]}]}], "}"}]}], ";"}], 
   "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"numabfactor", "[", "n_", "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"ab", "@@@", 
      RowBox[{
       RowBox[{"Subsets", "[", 
        RowBox[{
         RowBox[{"Range", "[", "n", "]"}], ",", 
         RowBox[{"{", "4", "}"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{
            FractionBox["exp", 
             RowBox[{"ab", "@@@", 
              RowBox[{"Subsets", "[", 
               RowBox[{
                RowBox[{"Range", "[", "n", "]"}], ",", 
                RowBox[{"{", "4", "}"}]}], "]"}]}]], "//", "neab"}], ",", 
           "_Integer"}], "]"}], "]"}], "]"}], "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"prenumabfactor", "[", "n_", "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"neab", "[", 
      FractionBox["exp", 
       RowBox[{"ab", "@@@", 
        RowBox[{"Subsets", "[", 
         RowBox[{
          RowBox[{"Range", "[", "n", "]"}], ",", 
          RowBox[{"{", "4", "}"}]}], "]"}]}]], "]"}]}], ";"}]}]}]], "Code",
 CellChangeTimes->{{3.8113291051334543`*^9, 3.8113291358771725`*^9}, {
   3.8113294989293756`*^9, 3.8113295178328276`*^9}, 3.81132955846049*^9, {
   3.8113296240730143`*^9, 3.811329641264002*^9}, {3.8113297558068576`*^9, 
   3.8113298000545425`*^9}, {3.8113298902792206`*^9, 
   3.8113299464320683`*^9}, {3.8113300102881975`*^9, 
   3.8113300404723153`*^9}, {3.8113300932061434`*^9, 
   3.8113301034058285`*^9}, {3.8113302544804544`*^9, 
   3.8113302729859657`*^9}, {3.8113303053743286`*^9, 3.811330331461645*^9}, {
   3.811330536395261*^9, 3.8113305482257075`*^9}, {3.81133080727201*^9, 
   3.811330810781666*^9}, {3.8113352647268076`*^9, 3.8113352650130415`*^9}, {
   3.811336832611292*^9, 3.8113369103264837`*^9}, {3.811396191747861*^9, 
   3.8113962216318827`*^9}, {3.811396989480481*^9, 3.811396991215836*^9}, {
   3.8113971584074087`*^9, 3.811397160872797*^9}, {3.8113972826239595`*^9, 
   3.8113972842735434`*^9}, {3.8113975416715307`*^9, 
   3.8113975535706854`*^9}, {3.8114158297232456`*^9, 
   3.8114158395010395`*^9}, {3.811415944312753*^9, 3.8114159448014455`*^9}, 
   3.8114162612147317`*^9, {3.8114163025610075`*^9, 3.8114163051032553`*^9}, 
   3.8114172742648973`*^9, {3.8114181712199554`*^9, 3.8114181858096533`*^9}, {
   3.8114224044604125`*^9, 3.8114224277401056`*^9}, {3.8114370638575478`*^9, 
   3.811437066684016*^9}, {3.81177849193333*^9, 3.811778523923793*^9}, {
   3.8117786218691373`*^9, 3.811778630421237*^9}, {3.811780067833497*^9, 
   3.8117800703278165`*^9}, {3.8117811357914553`*^9, 3.811781149383046*^9}, {
   3.8117812156040077`*^9, 3.8117812340297365`*^9}, 3.8121007503566804`*^9, {
   3.8133972626429853`*^9, 3.8133973004018917`*^9}, {3.813398173005844*^9, 
   3.813398174073983*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"818968fc-f594-4d9f-9d77-632c37268282"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monic", "[", 
    RowBox[{"preexp_", ",", "\[Tau]_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"exp", "=", 
       RowBox[{"Together", "[", "preexp", "]"}]}], "}"}], ",", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"d1", "=", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"Numerator", "[", "exp", "]"}], ",", "\[Tau]"}], "]"}]}], 
         ",", 
         RowBox[{"d2", "=", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"Denominator", "[", "exp", "]"}], ",", "\[Tau]"}], 
           "]"}]}]}], "}"}], ",", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"d1", "===", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Tau]", "+", 
                RowBox[{"Simplify", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Denominator", "[", "exp", "]"}], "/.", 
                    RowBox[{"\[Tau]", "->", "0"}]}], ")"}], "/", "d2"}], 
                 "]"}]}], "/.", "tocaps"}], "/.", "sortab"}], ")"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Simplify", "[", 
              RowBox[{
               RowBox[{"Numerator", "[", "exp", "]"}], "/", "d2"}], "]"}], "/.",
              "tocaps"}], "/.", "sortab"}]}], "}"}], ",", 
         RowBox[{"d2", "===", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Tau]", "+", 
               RowBox[{"Simplify", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Numerator", "[", "exp", "]"}], "/.", 
                   RowBox[{"\[Tau]", "->", "0"}]}], ")"}], "/", "d1"}], 
                "]"}]}], "/.", "tocaps"}], "/.", "sortab"}], ")"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Simplify", "[", 
              RowBox[{"d1", "/", 
               RowBox[{"Denominator", "[", "exp", "]"}]}], "]"}], "/.", 
             "tocaps"}], "/.", "sortab"}]}], "}"}], ",", 
         RowBox[{
          RowBox[{"d1", "=!=", "0"}], "&&", 
          RowBox[{"d2", "=!=", "0"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Tau]", "+", 
                RowBox[{"Simplify", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Numerator", "[", "exp", "]"}], "/.", 
                    RowBox[{"\[Tau]", "->", "0"}]}], ")"}], "/", "d1"}], 
                 "]"}]}], "/.", "tocaps"}], "/.", "sortab"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Tau]", "+", 
                RowBox[{"Simplify", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Denominator", "[", "exp", "]"}], "/.", 
                    RowBox[{"\[Tau]", "->", "0"}]}], ")"}], "/", "d2"}], 
                 "]"}]}], "/.", "tocaps"}], "/.", "sortab"}], ")"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Simplify", "[", 
              RowBox[{"d1", "/", "d2"}], "]"}], "/.", "tocaps"}], "/.", 
            "sortab"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"logmonic", "[", "exp_", "]"}], ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"hh", "=", 
        RowBox[{"monic", "[", "exp", "]"}]}], "}"}], ",", 
      RowBox[{"Total", "[", 
       RowBox[{"log", "/@", "hh"}], "]"}]}], "]"}]}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{"PolyLogs", " ", "to", " ", "Symbols"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"tosymbol", "[", "exp_", "]"}], ":=", 
    RowBox[{"exp", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"PolyLog", "[", 
         RowBox[{"2", ",", "x_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"-", 
         RowBox[{"Tensor", "[", 
          RowBox[{
           RowBox[{"1", "-", "x"}], ",", "x"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Log", "[", "x_", "]"}], 
         RowBox[{"Log", "[", "y_", "]"}]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"Tensor", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "+", 
         RowBox[{"Tensor", "[", 
          RowBox[{"y", ",", "x"}], "]"}]}]}]}], "}"}]}]}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"some", " ", "symbol", " ", "calculation"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"tensor", "[", 
   RowBox[{"x___", ",", 
    RowBox[{"y_", " ", "z_"}], ",", "w___"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"tensor", "[", 
    RowBox[{"x", ",", "y", ",", "w"}], "]"}], "+", 
   RowBox[{"tensor", "[", 
    RowBox[{"x", ",", "z", ",", "w"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tensor", "[", 
   RowBox[{"x___", ",", 
    RowBox[{"y_", " ", "/", "z_"}], ",", "w___"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"tensor", "[", 
    RowBox[{"x", ",", "y", ",", "w"}], "]"}], "-", 
   RowBox[{"tensor", "[", 
    RowBox[{"x", ",", "z", ",", "w"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tensor", "[", 
   RowBox[{"x___", ",", 
    RowBox[{"1", "/", "y_"}], ",", "w___"}], "]"}], ":=", 
  RowBox[{"-", 
   RowBox[{"tensor", "[", 
    RowBox[{"x", ",", "y", ",", "w"}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"tensor", "[", 
   RowBox[{"x___", ",", 
    RowBox[{"1", "/", "y_Integer"}], ",", "w___"}], "]"}], ":=", 
  RowBox[{"-", 
   RowBox[{"tensor", "[", 
    RowBox[{"x", ",", "y", ",", "w"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tensor", "[", 
   RowBox[{"x___", ",", 
    RowBox[{"y_", "^", "a_Integer"}], ",", "w___"}], "]"}], ":=", 
  RowBox[{"a", " ", 
   RowBox[{"tensor", "[", 
    RowBox[{"x", ",", "y", ",", "w"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tensor", "[", 
   RowBox[{"___", ",", 
    RowBox[{"1", "|", 
     RowBox[{"-", "1"}]}], ",", "___"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandTensor", "[", "exp_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Expand", "[", 
    RowBox[{
     RowBox[{"exp", "/.", 
      RowBox[{"Tensor", "\[Rule]", "tensor"}]}], ",", "_tensor"}], "]"}], "/.", 
   RowBox[{"tensor", "\[Rule]", "Tensor"}]}]}], "\n", 
 RowBox[{
  RowBox[{"ExpandTensor", "[", "exp_", "]"}], ":=", 
  RowBox[{"expandTensor", "[", 
   RowBox[{"exp", "/.", 
    RowBox[{
     RowBox[{"Tensor", "[", "x__", "]"}], "\[RuleDelayed]", 
     RowBox[{"Tensor", "@@", 
      RowBox[{"(", 
       RowBox[{"Factor", "/@", 
        RowBox[{"{", "x", "}"}]}], ")"}]}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"Shuffle", "[", 
   RowBox[{"s1_", ",", "s2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p", ",", "tp", ",", "ord"}], "}"}], ",", 
    RowBox[{
     RowBox[{"p", "=", 
      RowBox[{
       RowBox[{"Permutations", "@", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"1", "&"}], "/@", "s1"}], ",", 
          RowBox[{
           RowBox[{"0", "&"}], "/@", "s2"}]}], "]"}]}], "\[Transpose]"}]}], 
     ";", 
     RowBox[{"tp", "=", 
      RowBox[{"BitXor", "[", 
       RowBox[{"p", ",", "1"}], "]"}]}], ";", 
     RowBox[{"ord", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Accumulate", "[", "p", "]"}], " ", "p"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Accumulate", "[", "tp", "]"}], "+", 
          RowBox[{"Length", "[", "s1", "]"}]}], ")"}], " ", "tp"}]}]}], ";", 
     RowBox[{
      RowBox[{
       RowBox[{"Outer", "[", 
        RowBox[{"Part", ",", 
         RowBox[{"{", 
          RowBox[{"Join", "[", 
           RowBox[{"s1", ",", "s2"}], "]"}], "}"}], ",", "ord", ",", "1"}], 
        "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[Transpose]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"GetAlphabet", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Cases", "[", 
    RowBox[{"x", ",", 
     RowBox[{
      RowBox[{"Tensor", "[", "y__", "]"}], "\[RuleDelayed]", "y"}], ",", 
     "Infinity"}], "]"}], "//", "Union"}]}], "\n", 
 RowBox[{
  RowBox[{"isRationalSymbolzero", "[", "$x_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"$x", "===", "0"}], ",", "True", ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Chop", "[", 
          RowBox[{"$x", "/.", 
           RowBox[{
            RowBox[{"Tensor", "[", "y__", "]"}], ":>", 
            RowBox[{"N", "[", 
             RowBox[{
              RowBox[{"Times", "@@", 
               RowBox[{"(", 
                RowBox[{"Log", "/@", 
                 RowBox[{"Abs", "/@", 
                  RowBox[{"{", "y", "}"}]}]}], ")"}]}], ",", "100"}], 
             "]"}]}]}], "]"}], "===", "0"}], ")"}]}], ",", "False", ",", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"weights", "=", 
           RowBox[{"Length", "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"1", "+", "$x"}], ",", "_Tensor", ",", "Infinity"}], 
               "]"}], "//", "Union"}], ")"}]}]}], ",", 
          RowBox[{"x", "=", 
           RowBox[{
            RowBox[{"$x", "/.", 
             RowBox[{
              RowBox[{"Tensor", "[", 
               RowBox[{"___", ",", 
                RowBox[{"1", "|", 
                 RowBox[{"-", "1"}]}], ",", "___"}], "]"}], "\[RuleDelayed]", 
              "0"}]}], "/.", 
            RowBox[{
             RowBox[{"Tensor", "[", "y__", "]"}], ":>", 
             RowBox[{"Tensor", "@@", 
              RowBox[{"(", 
               RowBox[{"Abs", "/@", 
                RowBox[{"{", "y", "}"}]}], ")"}]}]}]}]}]}], "}"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "@@", "weights"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"weights", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "===", "1"}], ",", 
            RowBox[{
             RowBox[{"Chop", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"N", "[", 
                 RowBox[{"#", ",", "50"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{"x", "/.", 
                 RowBox[{
                  RowBox[{"Tensor", "[", "x_", "]"}], ":>", 
                  RowBox[{"Log", "[", 
                   RowBox[{"Abs", "[", "x", "]"}], "]"}]}]}], ")"}]}], "]"}], 
             "===", "0"}], ",", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"HH", ",", "hh", ",", "basis", ",", "coeffs"}], "}"}], 
              ",", 
              RowBox[{
               RowBox[{"hh", "=", 
                RowBox[{"Expand", "[", 
                 RowBox[{
                  RowBox[{"x", "/.", 
                   RowBox[{
                    RowBox[{"Tensor", "[", 
                    RowBox[{"y_", ",", "z__"}], "]"}], "\[RuleDelayed]", 
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"aaa", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], 
                    RowBox[{"HH", "[", 
                    RowBox[{"aaa", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], 
                    RowBox[{"Tensor", "[", "z", "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"aaa", ",", 
                    RowBox[{"FactorInteger", "[", "y", "]"}]}], "}"}]}], 
                    "]"}]}]}], ",", 
                  RowBox[{"_Tensor", "|", "_HH"}]}], "]"}]}], ";", 
               RowBox[{"basis", "=", 
                RowBox[{
                 RowBox[{"Cases", "[", 
                  RowBox[{"hh", ",", "_HH", ",", "Infinity"}], "]"}], "//", 
                 "Union"}]}], ";", 
               RowBox[{"coeffs", "=", 
                RowBox[{"Last", "@", 
                 RowBox[{"CoefficientArrays", "[", 
                  RowBox[{"hh", ",", "basis"}], "]"}]}]}], ";", 
               RowBox[{"AllTrue", "[", 
                RowBox[{"coeffs", ",", "isRationalSymbolzero"}], "]"}]}]}], 
             "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}]}], "Code",
 CellChangeTimes->{
  3.812037377634059*^9, {3.812037483746329*^9, 3.8120375480403776`*^9}, {
   3.812037850600196*^9, 3.8120378512514973`*^9}, {3.812038383192626*^9, 
   3.8120384167219734`*^9}, {3.812038448732545*^9, 3.8120384776232395`*^9}, {
   3.8120391771867895`*^9, 3.8120392055828266`*^9}, {3.8120393631445284`*^9, 
   3.812039391709279*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"6f02a5bf-4604-479f-a0f5-c0dc75672c83"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8120383557220783`*^9, 3.8120383652237043`*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"6bbba3b9-45f8-4af5-9c54-c567ee219e6e"],

Cell[BoxData[
 TemplateBox[{
  "Get", "noopen", 
   "\"Cannot open \\!\\(\\*RowBox[{\\\"\\\\\\\"Quit[]\\\\\\\"\\\"}]\\).\"", 2,
    47, 47, 27689517294327784504, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8120383612333765`*^9},
 CellLabel->
  "During evaluation of \
In[47]:=",ExpressionUUID->"a2f0dbfd-ce0c-4763-ae3b-5c53f8dbc3ff"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"integrate", " ", "symbol"}], ",", " ", 
    RowBox[{"debug", " ", "mode"}]}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"if", " ", "the", " ", "integral", " ", "is", " ", "finite"}], 
    ",", " ", 
    RowBox[{
    "all", " ", "ctensors", " ", "with", " ", "0", " ", "will", " ", "cancel",
      " ", "with", " ", "each", " ", "other"}]}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"Clear", "[", 
    RowBox[{"cint", ",", "ctensor"}], "]"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"ctensor", "[", 
      RowBox[{"___", ",", 
       RowBox[{"1", "|", 
        RowBox[{"-", "1"}]}], ",", "___"}], "]"}], ":=", "0"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"ctensor", "[", 
     RowBox[{"x___", ",", 
      RowBox[{
       RowBox[{"b_.", " ", 
        RowBox[{"ctensor", "[", "a__", "]"}]}], "+", "c_."}], ",", "y___"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"c", "===", "0"}], ",", 
        RowBox[{"b", " ", 
         RowBox[{"ctensor", "[", 
          RowBox[{"x", ",", "a", ",", "y"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"b", " ", 
          RowBox[{"ctensor", "[", 
           RowBox[{"x", ",", "a", ",", "y"}], "]"}]}], "+", 
         RowBox[{"ctensor", "[", 
          RowBox[{"x", ",", "c", ",", "y"}], "]"}]}]}], "]"}], ")"}], "/;", 
     RowBox[{"IntegerQ", "[", "b", "]"}]}]}], "\n", 
   RowBox[{
    RowBox[{"cint", "[", 
     RowBox[{
      RowBox[{"a_", "+", "b_"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Tau]_", ",", "x_", ",", "y_"}], "}"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"cint", "[", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"\[Tau]", ",", "x", ",", "y"}], "}"}]}], "]"}], "+", 
     RowBox[{"cint", "[", 
      RowBox[{"b", ",", 
       RowBox[{"{", 
        RowBox[{"\[Tau]", ",", "x", ",", "y"}], "}"}]}], "]"}]}]}], "\n", 
   RowBox[{
    RowBox[{"cint", "[", 
     RowBox[{
      RowBox[{"b_cinteger", " ", 
       RowBox[{"ctensor", "[", "c_", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Tau]_", ",", "x_", ",", "y_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"b", " ", 
     RowBox[{"cint", "[", 
      RowBox[{
       RowBox[{"ctensor", "[", "c", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Tau]", ",", "x", ",", "y"}], "}"}]}], "]"}]}]}], "\n", 
   RowBox[{
    RowBox[{"cint", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ctensor", "[", 
        RowBox[{"a__", ",", 
         RowBox[{"\[Tau]_", "+", "b_."}]}], "]"}], " ", 
       RowBox[{"dlog", "[", 
        RowBox[{"\[Tau]_", "+", "c_."}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Tau]_", ",", "x_", ",", "y_"}], "}"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"y", "===", "Infinity"}], ",", "0", ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ctensor", "[", 
          RowBox[{"a", ",", 
           RowBox[{"\[Tau]", "+", "b"}], ",", 
           RowBox[{"\[Tau]", "+", "c"}]}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{"\[Tau]", "->", "y"}], "}"}]}], ")"}]}], "]"}], "-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ctensor", "[", 
        RowBox[{"a", ",", 
         RowBox[{"\[Tau]", "+", "b"}], ",", 
         RowBox[{"\[Tau]", "+", "c"}]}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{"\[Tau]", "->", "x"}], "}"}]}], ")"}], "+", 
     RowBox[{"ctensor", "[", 
      RowBox[{
       RowBox[{"cint", "[", 
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{
           RowBox[{"ctensor", "[", "a", "]"}], " ", 
           RowBox[{"dlog", "[", 
            RowBox[{"\[Tau]", "+", "c"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Tau]", ",", "x", ",", "y"}], "}"}]}], "]"}], ",", 
       RowBox[{"b", "-", "c"}]}], "]"}], "-", 
     RowBox[{"ctensor", "[", 
      RowBox[{
       RowBox[{"cint", "[", 
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{
           RowBox[{"ctensor", "[", "a", "]"}], " ", 
           RowBox[{"dlog", "[", 
            RowBox[{"\[Tau]", "+", "b"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Tau]", ",", "x", ",", "y"}], "}"}]}], "]"}], ",", 
       RowBox[{"b", "-", "c"}]}], "]"}]}]}], "\n", 
   RowBox[{
    RowBox[{"cint", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ctensor", "[", 
        RowBox[{"a__", ",", "b_"}], "]"}], " ", 
       RowBox[{"dlog", "[", 
        RowBox[{"\[Tau]_", "+", "c_."}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Tau]_", ",", "x_", ",", "y_"}], "}"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"y", "===", "Infinity"}], ",", "0", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ctensor", "[", 
           RowBox[{"a", ",", "b", ",", 
            RowBox[{"\[Tau]", "+", "c"}]}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"\[Tau]", "->", "y"}], "}"}]}], ")"}]}], "]"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ctensor", "[", 
         RowBox[{"a", ",", "b", ",", 
          RowBox[{"\[Tau]", "+", "c"}]}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"\[Tau]", "->", "x"}], "}"}]}], ")"}], "+", 
      RowBox[{"ctensor", "[", 
       RowBox[{
        RowBox[{"cint", "[", 
         RowBox[{
          RowBox[{"Expand", "[", 
           RowBox[{
            RowBox[{"ctensor", "[", "a", "]"}], " ", 
            RowBox[{"dlog", "[", 
             RowBox[{"\[Tau]", "+", "c"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Tau]", ",", "x", ",", "y"}], "}"}]}], "]"}], ",", "b"}],
        "]"}]}], "/;", 
     RowBox[{"FreeQ", "[", 
      RowBox[{"b", ",", "\[Tau]"}], "]"}]}]}], "\n", 
   RowBox[{
    RowBox[{"cint", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ctensor", "[", 
        RowBox[{"\[Tau]_", "+", "b_."}], "]"}], " ", 
       RowBox[{"dlog", "[", 
        RowBox[{"\[Tau]_", "+", "c_."}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Tau]_", ",", "x_", ",", "y_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"y", "===", "Infinity"}], ",", 
      RowBox[{
       RowBox[{"ctensor", "[", 
        RowBox[{
         RowBox[{"b", "+", "x"}], ",", 
         RowBox[{"b", "-", "c"}]}], "]"}], "-", 
       RowBox[{"ctensor", "[", 
        RowBox[{
         RowBox[{"b", "+", "x"}], ",", 
         RowBox[{"c", "+", "x"}]}], "]"}], "-", 
       RowBox[{"ctensor", "[", 
        RowBox[{
         RowBox[{"c", "+", "x"}], ",", 
         RowBox[{"b", "-", "c"}]}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"ctensor", "[", 
        RowBox[{
         RowBox[{"b", "+", "x"}], ",", 
         RowBox[{"b", "-", "c"}]}], "]"}], "-", 
       RowBox[{"ctensor", "[", 
        RowBox[{
         RowBox[{"b", "+", "x"}], ",", 
         RowBox[{"c", "+", "x"}]}], "]"}], "-", 
       RowBox[{"ctensor", "[", 
        RowBox[{
         RowBox[{"c", "+", "x"}], ",", 
         RowBox[{"b", "-", "c"}]}], "]"}], "-", 
       RowBox[{"ctensor", "[", 
        RowBox[{
         RowBox[{"b", "+", "y"}], ",", 
         RowBox[{"b", "-", "c"}]}], "]"}], "+", 
       RowBox[{"ctensor", "[", 
        RowBox[{
         RowBox[{"b", "+", "y"}], ",", 
         RowBox[{"c", "+", "y"}]}], "]"}], "+", 
       RowBox[{"ctensor", "[", 
        RowBox[{
         RowBox[{"c", "+", "y"}], ",", 
         RowBox[{"b", "-", "c"}]}], "]"}]}]}], "]"}]}], "\n", 
   RowBox[{
    RowBox[{"cint", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ctensor", "[", "b_.", "]"}], " ", 
       RowBox[{"dlog", "[", 
        RowBox[{"\[Tau]_", "+", "c_."}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Tau]_", ",", "x_", ",", "y_"}], "}"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"y", "===", "Infinity"}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"ctensor", "[", 
          RowBox[{"b", ",", 
           RowBox[{"c", "+", "x"}]}], "]"}]}], "-", 
        RowBox[{"ctensor", "[", 
         RowBox[{
          RowBox[{"c", "+", "x"}], ",", "b"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"ctensor", "[", 
          RowBox[{"b", ",", 
           RowBox[{"c", "+", "x"}]}], "]"}]}], "+", 
        RowBox[{"ctensor", "[", 
         RowBox[{"b", ",", 
          RowBox[{"c", "+", "y"}]}], "]"}], "-", 
        RowBox[{"ctensor", "[", 
         RowBox[{
          RowBox[{"c", "+", "x"}], ",", "b"}], "]"}], "+", 
        RowBox[{"ctensor", "[", 
         RowBox[{
          RowBox[{"c", "+", "y"}], ",", "b"}], "]"}]}]}], "]"}], "/;", 
     RowBox[{"FreeQ", "[", 
      RowBox[{"b", ",", "\[Tau]"}], "]"}]}]}]}]}]], "Code",
 CellChangeTimes->{{3.812037331994481*^9, 3.8120373498591585`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"ec7917a3-a40d-4ee8-a992-283e98eb6a65"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"wtodp", "=", 
   RowBox[{"{", 
    RowBox[{"w", "->", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", "1", "]"}], 
       RowBox[{"P", "[", 
        RowBox[{"1", ",", "xx"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"a", "[", "2", "]"}], 
       RowBox[{"P", "[", 
        RowBox[{"4", ",", "yy"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"a", "[", "3", "]"}], 
       RowBox[{"P", "[", 
        RowBox[{"6", ",", "7"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"a", "[", "4", "]"}], 
       RowBox[{"P", "[", 
        RowBox[{"7", ",", "8"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"a", "[", "5", "]"}], 
       RowBox[{"P", "[", 
        RowBox[{"9", ",", "10"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"a", "[", "6", "]"}], 
       RowBox[{"P", "[", 
        RowBox[{"10", ",", "11"}], "]"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{"x_", ",", 
     RowBox[{"a_", "+", "b_"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"x", ",", "a"}], "]"}], "+", 
    RowBox[{"dot", "[", 
     RowBox[{"x", ",", "b"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"a_", "+", "b_"}], ",", "x_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a", ",", "x"}], "]"}], "+", 
    RowBox[{"dot", "[", 
     RowBox[{"b", ",", "x"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Qmat", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"Last", "@", 
     RowBox[{"CoefficientArrays", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{"w", ",", "w"}], "]"}], "/.", "wtodp"}], "//.", 
          RowBox[{
           RowBox[{"dot", "[", " ", 
            RowBox[{"x___", ",", 
             RowBox[{"a_", " ", "i_P"}], ",", "y___"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{"a", " ", 
            RowBox[{"dot", "[", 
             RowBox[{"x", ",", "i", ",", "y"}], "]"}]}]}]}], "/.", 
         RowBox[{
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"P", "[", "x__", "]"}], ",", 
            RowBox[{"P", "[", "y__", "]"}]}], "]"}], "\[RuleDelayed]", 
          RowBox[{"ab", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}]}], "/.", "sortab"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"a", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "6"}], "}"}]}], "]"}], ",", 
       RowBox[{"\"\<Symmetric\>\"", "->", "True"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tmat", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"Last", "@", 
     RowBox[{"CoefficientArrays", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"P", "[", 
               RowBox[{"cap2", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"12", ",", "1", ",", "2"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"3", ",", "4", ",", "5"}], "}"}]}], "]"}], "]"}], 
              ",", "w"}], "]"}], 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"P", "[", 
               RowBox[{"cap2", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"6", ",", "7", ",", "8"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"9", ",", "10", ",", "11"}], "}"}]}], "]"}], "]"}], 
              ",", "w"}], "]"}]}], "/.", "wtodp"}], "//.", 
          RowBox[{
           RowBox[{"dot", "[", " ", 
            RowBox[{"x___", ",", 
             RowBox[{"a_", " ", "i_P"}], ",", "y___"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{"a", " ", 
            RowBox[{"dot", "[", 
             RowBox[{"x", ",", "i", ",", "y"}], "]"}]}]}]}], "/.", 
         RowBox[{
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"P", "[", "x__", "]"}], ",", 
            RowBox[{"P", "[", "y__", "]"}]}], "]"}], "\[RuleDelayed]", 
          RowBox[{"ab", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}]}], "/.", "sortab"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"a", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "6"}], "}"}]}], "]"}], ",", 
       RowBox[{"\"\<Symmetric\>\"", "->", "True"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8133975805022273`*^9, 3.813397597385056*^9}, {
  3.813397640073446*^9, 3.8133976926464744`*^9}, {3.8133977596331067`*^9, 
  3.813397781608268*^9}, {3.8133978563539066`*^9, 3.8133978567000237`*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"f15b8827-f853-44cc-8426-69823f4a4132"],

Cell[CellGroupData[{

Cell[BoxData["Qmat"], "Input",
 CellChangeTimes->{{3.8133978039026513`*^9, 3.813397804565877*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"37c17423-5d70-4b43-abd4-bb50f5919345"],

Cell[BoxData[
 RowBox[{"\<\"Symmetric\"\>", "\[Rule]", "True"}]], "Output",
 CellChangeTimes->{3.8133978051004133`*^9},
 CellLabel->"Out[40]=",ExpressionUUID->"6c89e8d8-ff15-4a4b-865e-e18744180c0f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"coeff", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Inverse", "[", 
         RowBox[{"Drop", "[", 
          RowBox[{"Qmat", ",", 
           RowBox[{"{", "i", "}"}], ",", 
           RowBox[{"{", "i", "}"}]}], "]"}], "]"}], ".", 
        RowBox[{"(", 
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Inverse", "[", "Qmat", "]"}], ".", "Tmat"}], ")"}], 
            "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"{", "i", "}"}]}], "]"}], ")"}]}], ")"}], "[", 
      RowBox[{"[", 
       RowBox[{"j", "-", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Inverse", "[", 
         RowBox[{"Drop", "[", 
          RowBox[{"Qmat", ",", 
           RowBox[{"{", "j", "}"}], ",", 
           RowBox[{"{", "j", "}"}]}], "]"}], "]"}], ".", 
        RowBox[{"(", 
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Inverse", "[", "Qmat", "]"}], ".", "Tmat"}], ")"}], 
            "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{"{", "j", "}"}]}], "]"}], ")"}]}], ")"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}]}], ";", 
   RowBox[{
    RowBox[{"q", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Qmat", "[", 
         RowBox[{"[", 
          RowBox[{"a", ",", "b"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", 
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"Range", "[", "6", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "j"}], "}"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", 
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"Range", "[", "6", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "j"}], "}"}]}], "]"}]}], "}"}]}], "]"}], "//", 
      "Det"}], "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.8133977178851085`*^9, 3.813397723518079*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"2184a97b-3f58-4262-bbc9-6ce544c65b6d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"q", "[", 
      RowBox[{"3", ",", "5"}], "]"}], ",", 
     RowBox[{"q", "[", 
      RowBox[{"3", ",", "6"}], "]"}], ",", 
     RowBox[{"q", "[", 
      RowBox[{"4", ",", "5"}], "]"}], ",", 
     RowBox[{"q", "[", 
      RowBox[{"4", ",", "6"}], "]"}]}], "}"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xx", "\[RuleDelayed]", "2"}], ",", 
     RowBox[{"yy", "\[RuleDelayed]", "5"}]}], "}"}]}], "//", 
  "neabp"}]], "Input",
 CellChangeTimes->{{3.8133977294242744`*^9, 3.8133977308244877`*^9}, {
  3.813397870355445*^9, 3.8133978997478037`*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"722ad985-a008-4caa-b3ac-5f9232637400"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    SqrtBox["202559718561190999"], "69120"], ",", 
   FractionBox[
    RowBox[{"5", " ", 
     SqrtBox[
      FractionBox["18358666408281557", "2"]]}], "6912"], ",", 
   FractionBox[
    SqrtBox["459623426514973009"], "460800"], ",", 
   FractionBox[
    SqrtBox["102596790154881649"], "18432"]}], "}"}]], "Output",
 CellChangeTimes->{3.81339773140995*^9, 3.8133977881827164`*^9, 
  3.8133978661587133`*^9, 3.813397900719204*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"89a3c710-9f86-499b-a730-fc685bdcabdc"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"deltoab", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"del", "\[RuleDelayed]", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "u", "-", "v"}], ")"}], "2"], "-", 
        RowBox[{"4", "u", " ", "v"}]}], "]"}]}], ",", 
     RowBox[{"deln", "\[RuleDelayed]", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "un", "-", "vn"}], ")"}], "2"], "-", 
        RowBox[{"4", "un", " ", "vn"}]}], "]"}]}], ",", 
     RowBox[{"del2", "\[RuleDelayed]", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "u2", "-", "v2"}], ")"}], "2"], "-", 
        RowBox[{"4", "u2", " ", "v2"}]}], "]"}]}], ",", 
     RowBox[{"del3", ":>", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "u3", "-", "v3"}], ")"}], "2"], "-", 
        RowBox[{"4", "u3", " ", "v3"}]}], "]"}]}], ",", 
     RowBox[{"del5", ":>", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "u5", "-", "v5"}], ")"}], "2"], "-", 
        RowBox[{"4", "u5", " ", "v5"}]}], "]"}]}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"uvtoz", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"un", "\[RuleDelayed]", 
      RowBox[{"zn", " ", "znb"}]}], ",", 
     RowBox[{"vn", "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "zn"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "znb"}], ")"}]}]}], ",", 
     RowBox[{"u2", "\[RuleDelayed]", 
      RowBox[{"z2", " ", "z2b"}]}], ",", 
     RowBox[{"v2", "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "z2"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "z2b"}], ")"}]}]}], ",", 
     RowBox[{"u3", "\[RuleDelayed]", 
      RowBox[{"z3", " ", "z3b"}]}], ",", " ", 
     RowBox[{"v3", "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "z3"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "z3b"}], ")"}]}]}], ",", 
     RowBox[{"u5", "\[RuleDelayed]", 
      RowBox[{"z5", " ", "z5b"}]}], ",", 
     RowBox[{"v5", "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "z5"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "z5b"}], ")"}]}]}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ztoab", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"z", "\[RuleDelayed]", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "+", "u", "-", "v", "+", "del"}], ")"}]}]}], ",", 
     RowBox[{"zb", "\[RuleDelayed]", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "+", "u", "-", "v", "-", "del"}], ")"}]}]}], ",", 
     RowBox[{"zn", "\[RuleDelayed]", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "+", "un", "-", "vn", "+", "deln"}], ")"}]}]}], ",", 
     RowBox[{"znb", "\[RuleDelayed]", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "+", "un", "-", "vn", "-", "deln"}], ")"}]}]}], ",", 
     RowBox[{"z2", "\[RuleDelayed]", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "+", "u2", "-", "v2", "+", "del2"}], ")"}]}]}], ",", 
     RowBox[{"z2b", "\[RuleDelayed]", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "+", "u2", "-", "v2", "-", "del2"}], ")"}]}]}], ",", 
     RowBox[{"z3", "\[RuleDelayed]", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "+", "u3", "-", "v3", "+", "del3"}], ")"}]}]}], ",", 
     RowBox[{"z3b", "\[RuleDelayed]", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "+", "u3", "-", "v3", "-", "del3"}], ")"}]}]}], ",", 
     RowBox[{"z5", "\[RuleDelayed]", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "+", "u5", "-", "v5", "+", "del5"}], ")"}]}]}], ",", 
     RowBox[{"z5b", "\[RuleDelayed]", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "+", "u5", "-", "v5", "-", "del5"}], ")"}]}]}]}], 
    "}"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.813398248149845*^9, 3.8133983971561556`*^9}, {
  3.813398440728547*^9, 3.813398476419055*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"9a31d569-956c-461c-919f-962137785269"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"z3", "\[RuleDelayed]", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{"1", "+", "u3", "-", "v3", "+", "del3"}], ")"}]}]}], ",", 
   RowBox[{"z3b", "\[RuleDelayed]", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{"1", "+", "u3", "-", "v3", "-", "del3"}], ")"}]}]}]}], 
  "}"}]], "Input",
 CellChangeTimes->{{3.813398405441019*^9, 
  3.813398430299451*^9}},ExpressionUUID->"5135e108-0fca-4aee-be6f-\
91e233be8946"],

Cell[BoxData[
 StyleBox[
  RowBox[{"Rationalizing", " ", "the", " ", "square", " ", "root"}], 
  "Section"]], "Input",
 CellChangeTimes->{{3.813397930464326*^9, 
  3.8133979304663477`*^9}},ExpressionUUID->"8b73799e-3631-4e97-a1de-\
0cebdf7e4a88"],

Cell[CellGroupData[{

Cell["1. the square root for box[3,5]", "Subsubsection",
 CellChangeTimes->{{3.8133979320461364`*^9, 
  3.8133979496800747`*^9}},ExpressionUUID->"78de6ecf-7fda-4cfa-8fa6-\
5c77b85354de"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"w", "/.", "wtodp"}], ")"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", "3", "]"}], "\[RuleDelayed]", "0"}], ",", 
    RowBox[{
     RowBox[{"a", "[", "5", "]"}], "\[RuleDelayed]", "0"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.8133979968302436`*^9, 3.8133980156997166`*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"a805652e-4c6d-4373-962a-51e876ae7ee8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", "1", "]"}], " ", 
   RowBox[{"P", "[", 
    RowBox[{"1", ",", "xx"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "2", "]"}], " ", 
   RowBox[{"P", "[", 
    RowBox[{"4", ",", "yy"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "4", "]"}], " ", 
   RowBox[{"P", "[", 
    RowBox[{"7", ",", "8"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "6", "]"}], " ", 
   RowBox[{"P", "[", 
    RowBox[{"10", ",", "11"}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.813398000068568*^9, 3.813398016277174*^9}},
 CellLabel->"Out[49]=",ExpressionUUID->"e11d29cc-1e08-4a89-a09d-795f9558bf8e"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"uvtoab", "[", 
    RowBox[{"3", ",", "5"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"u", "\[RuleDelayed]", 
      FractionBox[
       RowBox[{
        RowBox[{"ab", "[", 
         RowBox[{"1", ",", "xx", ",", "4", ",", "yy"}], "]"}], 
        RowBox[{"ab", "[", 
         RowBox[{"7", ",", "8", ",", "10", ",", "11"}], "]"}]}], 
       RowBox[{
        RowBox[{"ab", "[", 
         RowBox[{"1", ",", "xx", ",", "7", ",", "8"}], "]"}], 
        RowBox[{"ab", "[", 
         RowBox[{"4", ",", "yy", ",", "10", ",", "11"}], "]"}]}]]}], ",", 
     RowBox[{"v", "\[RuleDelayed]", 
      FractionBox[
       RowBox[{
        RowBox[{"ab", "[", 
         RowBox[{"4", ",", "yy", ",", "7", ",", "8"}], "]"}], 
        RowBox[{"ab", "[", 
         RowBox[{"1", ",", "xx", ",", "10", ",", "11"}], "]"}]}], 
       RowBox[{
        RowBox[{"ab", "[", 
         RowBox[{"1", ",", "xx", ",", "7", ",", "8"}], "]"}], 
        RowBox[{"ab", "[", 
         RowBox[{"4", ",", "yy", ",", "10", ",", "11"}], "]"}]}]]}], ",", 
     RowBox[{"u3", ":>", 
      FractionBox[
       RowBox[{
        RowBox[{"ab", "[", 
         RowBox[{"1", ",", "xx", ",", "4", ",", "3"}], "]"}], 
        RowBox[{"ab", "[", 
         RowBox[{"7", ",", "8", ",", "10", ",", "11"}], "]"}]}], 
       RowBox[{
        RowBox[{"ab", "[", 
         RowBox[{"1", ",", "xx", ",", "7", ",", "8"}], "]"}], 
        RowBox[{"ab", "[", 
         RowBox[{"4", ",", "3", ",", "10", ",", "11"}], "]"}]}]]}], ",", 
     RowBox[{"v3", ":>", 
      FractionBox[
       RowBox[{
        RowBox[{"ab", "[", 
         RowBox[{"4", ",", "3", ",", "7", ",", "8"}], "]"}], 
        RowBox[{"ab", "[", 
         RowBox[{"1", ",", "xx", ",", "10", ",", "11"}], "]"}]}], 
       RowBox[{
        RowBox[{"ab", "[", 
         RowBox[{"1", ",", "xx", ",", "7", ",", "8"}], "]"}], 
        RowBox[{"ab", "[", 
         RowBox[{"4", ",", "3", ",", "10", ",", "11"}], "]"}]}]]}], ",", 
     RowBox[{"u5", "\[RuleDelayed]", 
      FractionBox[
       RowBox[{
        RowBox[{"ab", "[", 
         RowBox[{"1", ",", "xx", ",", "4", ",", "5"}], "]"}], 
        RowBox[{"ab", "[", 
         RowBox[{"7", ",", "8", ",", "10", ",", "11"}], "]"}]}], 
       RowBox[{
        RowBox[{"ab", "[", 
         RowBox[{"1", ",", "xx", ",", "7", ",", "8"}], "]"}], 
        RowBox[{"ab", "[", 
         RowBox[{"4", ",", "5", ",", "10", ",", "11"}], "]"}]}]]}], ",", 
     RowBox[{"v5", "\[RuleDelayed]", 
      FractionBox[
       RowBox[{
        RowBox[{"ab", "[", 
         RowBox[{"4", ",", "5", ",", "7", ",", "8"}], "]"}], 
        RowBox[{"ab", "[", 
         RowBox[{"1", ",", "xx", ",", "10", ",", "11"}], "]"}]}], 
       RowBox[{
        RowBox[{"ab", "[", 
         RowBox[{"1", ",", "xx", ",", "7", ",", "8"}], "]"}], 
        RowBox[{"ab", "[", 
         RowBox[{"4", ",", "5", ",", "10", ",", "11"}], "]"}]}]]}]}], "}"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"sigtot", "[", 
    RowBox[{"3", ",", "5"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"\[Sigma]", ":>", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"ab", "[", 
          RowBox[{"3", ",", "4", ",", "7", ",", "8"}], "]"}], " ", 
         RowBox[{"ab", "[", 
          RowBox[{"4", ",", "5", ",", "6", ",", "7"}], "]"}]}], 
        RowBox[{
         RowBox[{"ab", "[", 
          RowBox[{"3", ",", "4", ",", "6", ",", "7"}], "]"}], " ", 
         RowBox[{"ab", "[", 
          RowBox[{"4", ",", "5", ",", "7", ",", "8"}], "]"}]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["t", "2"], "+", 
          RowBox[{"t", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "u3", "-", "v3"}], ")"}]}], "+", "v3"}],
          ")"}], " ", "v5"}], 
       RowBox[{"v3", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["t", "2"], "+", 
          RowBox[{"t", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "u5", "-", "v5"}], ")"}]}], "+", "v5"}],
          ")"}]}]]}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"xytoab", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Mu]", ":>", 
      FractionBox[
       RowBox[{
        RowBox[{"ab", "[", 
         RowBox[{"4", ",", 
          RowBox[{"cap1", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"3", ",", "5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"7", ",", "8"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "xx"}], "}"}]}], "]"}]}], "]"}], 
        RowBox[{"ab", "[", 
         RowBox[{"10", ",", "11", ",", "1", ",", "xx"}], "]"}]}], 
       RowBox[{
        RowBox[{"ab", "[", 
         RowBox[{"4", ",", 
          RowBox[{"cap1", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"3", ",", "5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"10", ",", "11"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "xx"}], "}"}]}], "]"}]}], "]"}], 
        RowBox[{"ab", "[", 
         RowBox[{"7", ",", "8", ",", "1", ",", "xx"}], "]"}]}]]}], ",", 
     RowBox[{"\[Nu]", ":>", 
      FractionBox[
       RowBox[{
        RowBox[{"ab", "[", 
         RowBox[{"4", ",", 
          RowBox[{"cap1", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"3", ",", "5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "xx"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"10", ",", "11"}], "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"ab", "[", 
         RowBox[{"10", ",", "11", ",", "7", ",", "8"}], "]"}]}], 
       RowBox[{
        RowBox[{"ab", "[", 
         RowBox[{"4", ",", 
          RowBox[{"cap1", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"3", ",", "5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"7", ",", "8"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"10", ",", "11"}], "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"ab", "[", 
         RowBox[{"10", ",", "11", ",", "1", ",", "xx"}], "]"}]}]]}]}], 
    "}"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.8133980194397593`*^9, 3.8133981246601176`*^9}, {
  3.813398781931734*^9, 3.8133987823646164`*^9}, {3.813399310387947*^9, 
  3.8133993373751864`*^9}, {3.813399563162634*^9, 3.813399673948763*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"f979b685-b476-4e89-8196-63c9f4546331"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "/.", 
        RowBox[{"uvtoab", "[", 
         RowBox[{"3", ",", "5"}], "]"}]}], "/.", "yexpand"}], ")"}], 
     "\[Equal]", "0"}], ",", "\[Sigma]"}], "]"}], "/.", "sortab"}]], "Input",
 CellChangeTimes->{{3.8133987101628084`*^9, 3.81339875204973*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"13582d33-2d4a-4453-8327-2bd28fc1559e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[Sigma]", "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"ab", "[", 
        RowBox[{"3", ",", "4", ",", "7", ",", "8"}], "]"}], " ", 
       RowBox[{"ab", "[", 
        RowBox[{"4", ",", "5", ",", "6", ",", "7"}], "]"}]}], 
      RowBox[{
       RowBox[{"ab", "[", 
        RowBox[{"3", ",", "4", ",", "6", ",", "7"}], "]"}], " ", 
       RowBox[{"ab", "[", 
        RowBox[{"4", ",", "5", ",", "7", ",", "8"}], "]"}]}]]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8133987145221357`*^9, 3.813398752463578*^9}},
 CellLabel->"Out[88]=",ExpressionUUID->"f9ba4b25-c2c5-48dc-983e-180a2bb11e21"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"z", ",", "zb"}], "}"}], "/.", "ztoab"}], "/.", 
               "deltoab"}], "/.", 
              RowBox[{"uvtoab", "[", 
               RowBox[{"3", ",", "5"}], "]"}]}], "/.", "yexpand"}], "/.", 
            RowBox[{"sigtot", "[", 
             RowBox[{"3", ",", "5"}], "]"}]}], "/.", "ztoab"}], "/.", 
          "deltoab"}], "/.", 
         RowBox[{"uvtoab", "[", 
          RowBox[{"3", ",", "5"}], "]"}]}], "/.", "xexpand"}], "//", 
       "neabp"}], ",", 
      RowBox[{
       RowBox[{"\[Tau]", ">", "0"}], "&&", 
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{"neabp", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"1", "-", "z5b"}], "/.", "ztoab"}], "/.", "deltoab"}], 
             "/.", 
             RowBox[{"uvtoab", "[", 
              RowBox[{"3", ",", "5"}], "]"}]}], "/.", "xexpand"}], "]"}], ",", 
          RowBox[{"\[Tau]", ">", "0"}]}], "]"}], "<", "t", "<", 
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{"neabp", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"1", "-", "z3b"}], "/.", "ztoab"}], "/.", "deltoab"}], 
             "/.", 
             RowBox[{"uvtoab", "[", 
              RowBox[{"3", ",", "5"}], "]"}]}], "/.", "xexpand"}], "]"}], ",", 
          RowBox[{"\[Tau]", ">", "0"}]}], "]"}]}]}]}], "]"}], "-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"t", "-", "\[Mu]"}], ")"}], " ", "\[Nu]"}], 
           RowBox[{"1", "+", 
            RowBox[{"t", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Nu]"}], ")"}]}]}]], ",", 
          RowBox[{"1", "-", "t"}]}], "}"}], "/.", "xytoab"}], "/.", 
       "capexpand"}], "/.", "xexpand"}], ")"}]}], "//", "neabp"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.813398126048413*^9, 3.813398141012373*^9}, {
   3.813398189236415*^9, 3.813398194026594*^9}, {3.8133985131896725`*^9, 
   3.8133987044769697`*^9}, {3.8133987571041617`*^9, 
   3.8133987917813807`*^9}, {3.813399384564242*^9, 3.813399468638657*^9}, 
   3.8133996556587024`*^9, {3.813399767439625*^9, 3.8133998127374306`*^9}, {
   3.8133998614650135`*^9, 3.8133998792384596`*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"d9075eff-6991-48c6-8bdd-20002dbdc1b1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.813398130170378*^9, 3.8133981414880924`*^9}, {
   3.8133981831127944`*^9, 3.8133981944913154`*^9}, {3.8133985202483425`*^9, 
   3.8133985259700336`*^9}, {3.8133986442568674`*^9, 3.813398705328732*^9}, 
   3.8133987585502925`*^9, 3.813398792388784*^9, {3.8133994193973994`*^9, 
   3.8133994692589917`*^9}, 3.8133996562999463`*^9, {3.8133997916787715`*^9, 
   3.8133998135103197`*^9}, {3.8133998759183426`*^9, 3.81339987986977*^9}},
 CellLabel->
  "Out[110]=",ExpressionUUID->"1c583c56-1165-4c5c-a8ec-991a16957bfd"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"numq", "[", 
    RowBox[{"3", ",", "5"}], "]"}], "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"q", "[", 
                RowBox[{"3", ",", "5"}], "]"}], "/.", "ztoab"}], "/.", 
              "deltoab"}], "/.", 
             RowBox[{"uvtoab", "[", 
              RowBox[{"3", ",", "5"}], "]"}]}], "/.", "yexpand"}], "/.", 
           RowBox[{"sigtot", "[", 
            RowBox[{"3", ",", "5"}], "]"}]}], "/.", "ztoab"}], "/.", 
         "deltoab"}], "/.", 
        RowBox[{"uvtoab", "[", 
         RowBox[{"3", ",", "5"}], "]"}]}], "/.", "xexpand"}], "//", "neabp"}],
      ",", 
     RowBox[{
      RowBox[{"\[Tau]", ">", "0"}], "&&", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"neabp", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"1", "-", "z5b"}], "/.", "ztoab"}], "/.", "deltoab"}], "/.", 
            RowBox[{"uvtoab", "[", 
             RowBox[{"3", ",", "5"}], "]"}]}], "/.", "xexpand"}], "]"}], ",", 
         RowBox[{"\[Tau]", ">", "0"}]}], "]"}], "<", "t", "<", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"neabp", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"1", "-", "z3b"}], "/.", "ztoab"}], "/.", 
             RowBox[{"deltoab", "[", 
              RowBox[{"3", ",", "5"}], "]"}]}], "/.", "uvtoab"}], "/.", 
           "xexpand"}], "]"}], ",", 
         RowBox[{"\[Tau]", ">", "0"}]}], "]"}]}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8134000726499305`*^9, 3.813400119106632*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"9d4104d8-a29b-48e7-a715-669a9f68fc40"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"numcoeff", "[", 
    RowBox[{"3", ",", "5"}], "]"}], "=", 
   RowBox[{"Factor", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"ab", "[", 
            RowBox[{"10", ",", "11", ",", "12", ",", "1"}], "]"}], 
           RowBox[{"ab", "[", 
            RowBox[{"10", ",", "11", ",", "1", ",", "2"}], "]"}]], 
          FractionBox[
           RowBox[{"ab", "[", 
            RowBox[{"3", ",", "4", ",", "6", ",", "7"}], "]"}], 
           RowBox[{"ab", "[", 
            RowBox[{"4", ",", "5", ",", "6", ",", "7"}], "]"}]], 
          FractionBox[
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "4", ",", "7", ",", "10"}], "]"}], 
           RowBox[{"ab", "[", 
            RowBox[{"1", ",", "xx", ",", "4", ",", "yy"}], "]"}]], 
          RowBox[{"(", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Simplify", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{
                    RowBox[{"\[Sigma]", "/.", 
                    RowBox[{"sigtot", "[", 
                    RowBox[{"3", ",", "5"}], "]"}]}], ",", "t"}], "]"}], "/.",
                   "ztoab"}], "/.", "deltoab"}], "]"}], "/.", 
               RowBox[{"uvtoab", "[", 
                RowBox[{"3", ",", "5"}], "]"}]}], "/.", "xexpand"}], "//", 
             "neabp"}], 
            RowBox[{"numq", "[", 
             RowBox[{"3", ",", "5"}], "]"}]], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"coeff", "[", 
             RowBox[{"3", ",", "5"}], "]"}], "//.", "capexpand"}], ")"}]}], "/.",
          "yexpand"}], "/.", 
        RowBox[{"sigtot", "[", 
         RowBox[{"3", ",", "5"}], "]"}]}], "/.", 
       RowBox[{"uvtoab", "[", 
        RowBox[{"3", ",", "5"}], "]"}]}], "/.", "xexpand"}], "//", "neabp"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8134001613645687`*^9, 3.8134001956727743`*^9}, {
   3.8134002868999114`*^9, 3.813400356162509*^9}, {3.813400454734734*^9, 
   3.813400472360613*^9}, {3.8134005381266527`*^9, 3.8134005391678996`*^9}, 
   3.813401465052808*^9},ExpressionUUID->"7b7ca64a-5b71-4020-84d7-\
0d6121b70f9d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dlogform", "[", 
    RowBox[{"3", ",", "5"}], "]"}], "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"dlogx", "[", 
         FractionBox[
          RowBox[{"ab", "[", 
           RowBox[{"1", ",", "4", ",", "7", ",", "xx"}], "]"}], 
          RowBox[{"ab", "[", 
           RowBox[{"1", ",", "4", ",", "10", ",", "xx"}], "]"}]], "]"}]}], 
       RowBox[{"dlogt", "[", 
        FractionBox[
         RowBox[{"t", "-", "1"}], 
         RowBox[{"t", "-", "\[Mu]"}]], "]"}]}], "-", 
      RowBox[{
       RowBox[{"dlogx", "[", 
        FractionBox[
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "4", ",", "7", ",", "xx"}], "]"}], 
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "7", ",", "10", ",", "xx"}], "]"}]], "]"}], 
       RowBox[{"dlogt", "[", 
        FractionBox[
         RowBox[{"t", "+", 
          FractionBox[
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{"1", ",", "xx", ",", "10", ",", "11"}], "]"}], " ", 
            RowBox[{"ab", "[", 
             RowBox[{"3", ",", "4", ",", "5", ",", "7"}], "]"}]}], 
           RowBox[{"ab", "[", 
            RowBox[{"3", ",", "4", ",", "5", ",", 
             RowBox[{"cap", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"10", ",", "11"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"7", ",", "1", ",", "xx"}], "}"}]}], "]"}]}], 
            "]"}]]}], 
         RowBox[{"t", "-", 
          FractionBox[
           RowBox[{"ab", "[", 
            RowBox[{"7", ",", 
             RowBox[{"cap1", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"10", ",", "11"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "xx"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"4", ",", "8"}], "}"}]}], "]"}]}], "]"}], 
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{"7", ",", "1", ",", "xx", ",", "8"}], "]"}], " ", 
            RowBox[{"ab", "[", 
             RowBox[{"7", ",", "4", ",", "10", ",", "11"}], "]"}]}]]}]], 
        "]"}]}], "-", 
      RowBox[{
       RowBox[{"dlogx", "[", 
        FractionBox[
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "7", ",", "10", ",", "xx"}], "]"}], 
         RowBox[{"ab", "[", 
          RowBox[{"1", ",", "4", ",", "10", ",", "xx"}], "]"}]], "]"}], 
       RowBox[{"dlogt", "[", 
        FractionBox[
         RowBox[{"t", "-", 
          FractionBox[
           RowBox[{"ab", "[", 
            RowBox[{"3", ",", "4", ",", "5", ",", 
             RowBox[{"cap", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"7", ",", "8"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"10", ",", "1", ",", "xx"}], "}"}]}], "]"}]}], "]"}], 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"ab", "[", 
              RowBox[{"3", ",", "4", ",", "5", ",", "10"}], "]"}]}], 
            RowBox[{"ab", "[", 
             RowBox[{"1", ",", "xx", ",", "7", ",", "8"}], "]"}]}]]}], 
         RowBox[{"t", "-", 
          FractionBox[
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{"7", ",", "8", ",", "10", ",", "4"}], "]"}], 
            RowBox[{"ab", "[", 
             RowBox[{"10", ",", "11", ",", "1", ",", "xx"}], "]"}]}], 
           RowBox[{"ab", "[", 
            RowBox[{"10", ",", 
             RowBox[{"cap1", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "xx"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"7", ",", "8"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"11", ",", "4"}], "}"}]}], "]"}]}], "]"}]]}]], 
        "]"}]}]}], ")"}]}]}], ";"}]], "Code",
 CellChangeTimes->{{3.8134006266678314`*^9, 3.8134006521287336`*^9}, {
  3.8134007290658827`*^9, 3.8134008822615995`*^9}, {3.813400917328749*^9, 
  3.8134009663475904`*^9}, {3.813401206628934*^9, 3.81340122359454*^9}, {
  3.8134014037308435`*^9, 3.813401440684003*^9}, {3.8134016544500613`*^9, 
  3.81340176702466*^9}},
 CellLabel->
  "In[152]:=",ExpressionUUID->"2310f0a6-210e-4583-aa32-e4d7dba36569"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"numcoeff", "[", 
         RowBox[{"3", ",", "5"}], "]"}], "-", 
        RowBox[{"dlogform", "[", 
         RowBox[{"3", ",", "5"}], "]"}]}], "/.", "xytoab"}], "/.", 
      "capexpand"}], "/.", "xexpand"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dlogt", "[", "x_", "]"}], "\[RuleDelayed]", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"Log", "[", "x", "]"}], ",", "t"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"dlogx", "[", "a_", "]"}], "\[RuleDelayed]", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"Log", "[", "a", "]"}], ",", "\[Tau]"}], "]"}]}]}], "}"}]}], 
   "//", "neabp"}], "]"}]], "Input",
 CellChangeTimes->{{3.813400994956764*^9, 3.8134010981172276`*^9}, {
   3.813401247939409*^9, 3.8134012781415997`*^9}, 3.8134013791594825`*^9, {
   3.8134014220169163`*^9, 3.813401426116021*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"a1c4d6d9-bc88-4f34-b793-296747722a69"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.8134009987925053`*^9, 3.8134010987515664`*^9}, {
   3.8134012492349396`*^9, 3.81340127867517*^9}, 3.8134013803443155`*^9, {
   3.8134014268110905`*^9, 3.813401447429959*^9}, 3.813401665545377*^9, {
   3.8134017638801146`*^9, 3.8134017700555515`*^9}},
 CellLabel->
  "Out[153]=",ExpressionUUID->"808e2bcb-938f-40f2-ad67-534d75710f40"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1086.857142857143, 545.1428571428571},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1. Inherited,
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"d3c96f83-107a-4722-a42a-c52148aa82ac"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 153, 4, 28, "Input",ExpressionUUID->"4eed7f46-ab5e-4236-a45d-3697a690bc53"],
Cell[714, 26, 293, 6, 28, "Input",ExpressionUUID->"c2ff0413-27c4-4a73-a5e0-e9a8eca4f15f"],
Cell[1010, 34, 14074, 368, 484, "Code",ExpressionUUID->"818968fc-f594-4d9f-9d77-632c37268282"],
Cell[15087, 404, 13192, 363, 318, "Code",ExpressionUUID->"6f02a5bf-4604-479f-a0f5-c0dc75672c83"],
Cell[CellGroupData[{
Cell[28304, 771, 219, 4, 28, "Input",ExpressionUUID->"6bbba3b9-45f8-4af5-9c54-c567ee219e6e"],
Cell[28526, 777, 361, 9, 25, "Message",ExpressionUUID->"a2f0dbfd-ce0c-4763-ae3b-5c53f8dbc3ff"]
}, Open  ]],
Cell[28902, 789, 8919, 259, 228, "Code",ExpressionUUID->"ec7917a3-a40d-4ee8-a992-283e98eb6a65"],
Cell[37824, 1050, 4891, 141, 241, "Input",ExpressionUUID->"f15b8827-f853-44cc-8426-69823f4a4132"],
Cell[CellGroupData[{
Cell[42740, 1195, 177, 2, 28, "Input",ExpressionUUID->"37c17423-5d70-4b43-abd4-bb50f5919345"],
Cell[42920, 1199, 198, 3, 32, "Output",ExpressionUUID->"6c89e8d8-ff15-4a4b-865e-e18744180c0f"]
}, Open  ]],
Cell[43133, 1205, 2453, 72, 87, "Input",ExpressionUUID->"2184a97b-3f58-4262-bbc9-6ce544c65b6d"],
Cell[CellGroupData[{
Cell[45611, 1281, 711, 20, 28, "Input",ExpressionUUID->"722ad985-a008-4caa-b3ac-5f9232637400"],
Cell[46325, 1303, 564, 15, 63, "Output",ExpressionUUID->"89a3c710-9f86-499b-a730-fc685bdcabdc"]
}, Open  ]],
Cell[46904, 1321, 4591, 133, 105, "Code",ExpressionUUID->"9a31d569-956c-461c-919f-962137785269"],
Cell[51498, 1456, 522, 16, 45, "Input",ExpressionUUID->"5135e108-0fca-4aee-be6f-91e233be8946"],
Cell[52023, 1474, 246, 6, 48, "Input",ExpressionUUID->"8b73799e-3631-4e97-a1de-0cebdf7e4a88"],
Cell[CellGroupData[{
Cell[52294, 1484, 186, 3, 45, "Subsubsection",ExpressionUUID->"78de6ecf-7fda-4cfa-8fa6-5c77b85354de"],
Cell[CellGroupData[{
Cell[52505, 1491, 440, 12, 28, "Input",ExpressionUUID->"a805652e-4c6d-4373-962a-51e876ae7ee8"],
Cell[52948, 1505, 643, 19, 32, "Output",ExpressionUUID->"e11d29cc-1e08-4a89-a09d-795f9558bf8e"]
}, Open  ]],
Cell[53606, 1527, 6533, 183, 154, "Code",ExpressionUUID->"f979b685-b476-4e89-8196-63c9f4546331"],
Cell[CellGroupData[{
Cell[60164, 1714, 460, 12, 28, "Input",ExpressionUUID->"13582d33-2d4a-4453-8327-2bd28fc1559e"],
Cell[60627, 1728, 690, 18, 51, "Output",ExpressionUUID->"f9ba4b25-c2c5-48dc-983e-180a2bb11e21"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61354, 1751, 2857, 79, 147, "Input",ExpressionUUID->"d9075eff-6991-48c6-8bdd-20002dbdc1b1"],
Cell[64214, 1832, 609, 10, 32, "Output",ExpressionUUID->"1c583c56-1165-4c5c-a8ec-991a16957bfd"]
}, Open  ]],
Cell[64838, 1845, 1943, 56, 68, "Input",ExpressionUUID->"9d4104d8-a29b-48e7-a715-669a9f68fc40"],
Cell[66784, 1903, 2331, 60, 128, "Input",ExpressionUUID->"7b7ca64a-5b71-4020-84d7-0d6121b70f9d"],
Cell[69118, 1965, 4290, 113, 88, "Code",ExpressionUUID->"2310f0a6-210e-4583-aa32-e4d7dba36569"],
Cell[CellGroupData[{
Cell[73433, 2082, 1084, 30, 28, "Input",ExpressionUUID->"a1c4d6d9-bc88-4f34-b793-296747722a69"],
Cell[74520, 2114, 384, 6, 32, "Output",ExpressionUUID->"808e2bcb-938f-40f2-ad67-534d75710f40"]
}, Open  ]]
}, Open  ]]
}
]
*)

